<html>
	<head>
		<meta charset="UTF-8" />
		<title>Stop the Toxic</title>>
		<style>html,body{height: 100%; margin: 0; background-color}</style>
	</head>
	<body>
		<canvas id="glFrame"></canvas>
		<script type="text/javascript"> 
// setup dependencies
const dependencies = {
	['gl-matrix']: {loaded: null},
	asm: {loaded: null},
	render: {loaded: null}
};

function logStuff() {
	const mat = mat4.create();
	mat4.ortho(mat, 0,10, 0, 5, 0.9, 1.1);
	console.log(mat);
	const arr = new Uint8Array([255, 0, 0, 255]); 
	console.log(arr);
}
const loadCallBacks = [
	{dep: ['gl-matrix'], f: logStuff}];

function LoadedDep(dep) {
	dependencies[dep].loaded = true;
	loadCallBacks.filter(function(el) {return !!!el.dep || el.dep.includes(dep);}).forEach(function(el) {el.f();});
}
function LodaedASM() {
	// function mapping
	LoadedDep('asm');
}
// setup webasm
const Module = {
	onRuntimeInitialized: function(){LodaedASM();}	
};

// load gl context
const gl = document.getElementById('glFrame').getContext('webgl');
if(!!!gl) {
	alert('critial error: no webGl support, or data Corruption');
}

// setup refresh loop
var vendors = ['webkit', 'moz'];
for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {
    window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];
    window.cancelAnimationFrame =
      window[vendors[x]+'CancelAnimationFrame'] || window[vendors[x]+'CancelRequestAnimationFrame'];
}
if (!window.requestAnimationFrame)
    window.requestAnimationFrame = function(callback, element) {
        var currTime = new Date().getTime();
        var timeToCall = Math.max(0, 16 - (currTime - lastTime));
        var id = window.setTimeout(function() { callback(currTime + timeToCall); },
          timeToCall);
        lastTime = currTime + timeToCall;
        return id;
};

if (!window.cancelAnimationFrame)
    window.cancelAnimationFrame = function(id) {
      clearTimeout(id);
};
		</script>
		<script async onload="LoadedDep('gl-matrix')" src='gl-matrix.js'></script>
		<script async onload="LoadedDep('render')" src='render.js'></script>
		<script async src='wasmLoader.js'></script>
	</body>
</html>
